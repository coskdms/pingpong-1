<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Tutor">

<!-- 튜터 신청서 insert -->
<insert id="insert">
	insert into tutor_app values(tutor_app_seq.nextval,#{title},#{license},#{career},#{exp},#{introduce},#{recomm},default)
</insert>

<!-- 자격증 파일 insert -->
<insert id="insertFiles">
	insert into files values(files_seq.nextval,#{sysname}, #{oriname}, #{realpath,jdbcType=VARCHAR},'partner', 0)
</insert>

<!-- 강의 취소 신청서 -->
<insert id="lessonCancleProc">
	insert into delete_app values(delete_app_seq.nextval, #{id}, #{category}, #{contents}, #{parent_seq})
</insert>
<!-- 강의 눌렀을때 뿌려줄 강의 view -->
<resultMap id="lessonViewProfile" type="kh.pingpong.dto.LessonDTO">
   	<result property="sysname" column="profile" />
</resultMap>

<select id="lessonView" resultMap="lessonViewProfile">
	select * from lesson where seq=#{seq}
</select>

<!-- 튜터 프로필 뿌려주려고 -->
<resultMap id="TutorProfile" type="kh.pingpong.dto.MemberDTO">
   	<result property="sysname" column="profile" />
</resultMap>

<!-- 여기서부터 세개 튜터페이징 -->
<select id="selectTutorList" resultMap="TutorProfile">
	select * from (select member.*, row_number() over(order by grade desc) rnum from member where grade='tutor') 
	where rnum between #{start} and #{end}
</select>
<select id="getNextVal_tutor" resultType="int">
	select member_seq.nextval from dual
</select>

<select id="getArticleCount_tutor" resultType="int">
	select count(*) from member
</select>

<!-- 강의 리스트에 프로플 뿌려주려고 -->
<resultMap id="LessonProfile" type="kh.pingpong.dto.LessonDTO">
   	<result property="sysname" column="profile" />
</resultMap>
 
<!-- 여기서부터 세개 강의리스트 페이징 -->
<select id="selectLessonList" resultMap="LessonProfile">
	select * from (select lesson.*, row_number() over(order by seq desc) rnum from lesson) 
	where rnum between #{start} and #{end}
</select>

<select id="getNextVal_lesson" resultType="int">
	select lesson_seq.nextval from dual
</select>

<select id="getArticleCount_lesson" resultType="int">
	select count(*) from lesson
</select>



</mapper>